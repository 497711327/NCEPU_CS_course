# [数字逻辑与接口实验报告](https://github.com/IammyselfYBX/NCEPU_CS_course/blob/master/5.%E5%A4%A7%E4%B8%89%E4%B8%8A/1.%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E6%8E%A5%E5%8F%A3%E6%8A%80%E6%9C%AF(%E7%AC%AC4%E7%89%88)/%E5%AE%9E%E9%AA%8C/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%8E%A5%E5%8F%A3%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A.pdf)
<p align="right">计算1702 杨秉学</p>
<p align="right">学号：120171080212</p>

点击下载链接[数字逻辑与接口实验报告.pdf](https://github.com/IammyselfYBX/NCEPU_CS_course/blob/master/5.%E5%A4%A7%E4%B8%89%E4%B8%8A/1.%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E6%8E%A5%E5%8F%A3%E6%8A%80%E6%9C%AF(%E7%AC%AC4%E7%89%88)/%E5%AE%9E%E9%AA%8C/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E6%8E%A5%E5%8F%A3%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A.pdf)
#### 实验四 七段数码管实验报告
##### 一、实验目的
&emsp;&emsp;掌握数码管显示数字的原理
 
##### 二、实验代码
```
;**************************************
;*           LED数码管实验            *
;*       动态循环显示 "00-99"         *
;**************************************
data  segment
io8255a        equ 288h
io8255c        equ 28ah
io8255ctrl     equ 28bh

led      db   3fh,06h,5bh,4fh,66h,6dh,7dh,07h,7fh,6fh ;段码 显示0~9
buffer1  db   0,0         ;存放要显示的十位和个位
bz       dw   ?           ;位码
data ends

code  segment
    assume cs:code,ds:data
start:    
    mov ax,data
    mov ds,ax
    mov dx,io8255ctrl           ;将8255设为A口输出
    mov al,80h
    out dx,al
    mov di,offset buffer1      ;设di为显示缓冲区

;----------------------------------------------------------
;loop1:    mov cx,0300h               ;循环次数
loop1:    
    mov cx,030h               ;循环次数

loop2:  
    mov bh,02
lll:    

    mov byte ptr bz,bh
    push di
    dec di
    add di, bz
    mov bl,[di]                  ;bl为要显示的数 修改bl->bh
    pop di
    mov bh,0
    mov si,offset led            ;置led数码表偏移地址为SI
    add si,bx                    ;求出对应的led数码
    mov al,byte ptr [si]
    mov dx,io8255a               ;自8255A的口输出
    out dx,al
    mov al,byte ptr bz           ;使相应的数码管发光
    mov dx,io8255c
    out dx,al
    push cx
    mov cx,100                 
delay:
    loop delay                  ;延时
    pop cx

    mov al,00h
    out dx,al
    
    mov bh,byte ptr bz
    shr bh,1
    jnz lll
    loop loop2                  ;循环延时
    mov  ax,word ptr [di]
    cmp  ah,09
    jnz  set
    cmp  al,09
    jnz  set
    mov  ax,0000
    mov  [di],al
    mov  [di+1],ah
    jmp  loop1

set:    
    mov  ah,01
    int  16h
    jne  exit                   ;有键按下则跳转exit
    mov  ax,word ptr [di]
    inc  al
    aaa
    mov [di],al                 ;al为十位
    mov [di+1],ah               ;ah中为个位
    jmp loop1

;---------------------------------------------------
exit:    
    mov dx,io8255c
    mov al,0                    ;关掉数码管显示
    out dx,al
    mov ah,4ch                  ;返回
    int 21h
code ends
    end start
```
##### 三、总结：
&emsp;&emsp;1.接线的时候左右没什么关系，但是需要对应的引脚相连<br>
&emsp;&emsp;2.应该先接线，然后在打开开关<br>


##### 实验五 键盘显示控制实验实验报告
##### 一、实验目的
&emsp;&emsp;1、掌握8255控制键盘及显示电路的基本功能及编程方法。<br>
&emsp;&emsp;2、掌握一般键盘和显示电路的工作原理。

##### 二、代码
```masm
;********************;
;* 8255薄膜按键实验 *;
;********************;
 a8255        equ 288H    ;8255 A口    
 c8255        equ 28aH    ;8255 C口
 k8255        equ 28bH    ;8255控制口
data segment
 table1    dw 0770h,0B70h,0D70h,0E70h,07B0h,0BB0h,0DB0h,0EB0h
           dw 07D0h,0BD0h,0DD0h,0ED0h,07E0h,0BE0h,0DE0h,0EE0h    ;键盘扫描码表
 LED       DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,6FH,77H,7CH
           DB 39h,5EH,79h,71h,0ffh                               ;LED段码表 0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f
char  db '0123456789ABCDEF'                                      ;字符表
mes   db 0ah,0dh,'PLAY ANY KEY IN THE SMALL KEYBOARD! ',0ah,0dh
       db 'IT WILL BE ON THE SCREEN! END WITH E ',0ah,0dh,'$'
 key_in db 0h
data ends

stacks segment stack    ;堆栈空间
     db 100 dup (?)
stacks ends

code segment
        assume cs:code,ds:data,ss:stacks,es:data
start:
        cli
        mov ax,data
        mov ds,ax
        mov es,ax
        mov ax,stacks
        mov ss,ax
        mov dx,offset mes       ;显示提示信息
        mov ah,09
        int 21h  
        MOV DX,k8255            ;初始化8255控制字
        mov al,81h              ;0100 0001 方式1，a,b口输出，c口高4位输出，低4位输入
        out dx,al          

main_key:
        call key                ;get a char in (key_in) and display it
        call disply               	;调显示子程序，显示得到的字符
        cmp byte ptr key_in,'E'
        jnz main_key
        mov ax,4c00h            ;if (dl)='E' return to EXIT!
        int 21h                 ;退出
        key proc near

key_loop:
        mov ah,1
        int 16h
        jnz exit                    ;pc键盘有按键则退出
       
        mov dx,c8255
        mov al,0fh
        out dx,al
        in al,dx                    ;度行扫描值
        and al,0fh
        cmp al,0fh
        jz key_loop                 ;未发现有键按下则退出
        call delay                  ;delay for amoment
        mov ah,al
        MOV DX,k8255
        mov al,88h
        out dx,al
        mov dx,c8255
        mov al,ah
        and al,0f0h
        out dx,al
        in al,dx                    ;读行扫描值
        and al,0f0h
        cmp al,0f0h
        jz key_loop                 ;未发现有按键则跳转

        mov si,offset table1        ;键盘扫描码表首地址
        mov di,offset char          ;字符表首地址
        mov cx,16                   ;带查表的大小

key_tonext:
        cmp ax,[si]                 ;cmp (col,row) with every word
        jz key_findkey              ;in the table
        dec cx
        jz key_loop                 ;未找到对应扫描码
        inc si                    
        inc si                      ;新增inc si
        inc di
        jmp key_tonext

key_findkey:
        mov dl,[di]
        mov ah,02
        int 21h                    ;显示查找到的键盘码
        mov byte ptr key_in,dl

key_waitup:
        MOV DX,k8255
        mov al,81h
        out dx,al
        mov dx,c8255
        mov al,0fh
        out dx,al
        in al,dx           ;度行扫描值
        and al,0fh
        cmp al,0fh
        jnz key_waitup     ;按键未抬起跳转
        call delay         ;delay for amoment
        ret

exit:        
        mov byte ptr key_in,'E'
        ret
key endp

delay proc near
        push ax            ;delay 50ms--100ms
        mov ah,0
        int 1ah
        mov bx,dx
delay1:
        mov ah,0
        int 1ah
        cmp bx,dx
        jz delay1
        mov bx,dx
delay2:
        mov ah,0
        int 1ah
        cmp bx,dx
        jz delay2
        pop ax
       ret
delay endp

DISPLY PROC NEAR
    	PUSH ax
    	MOV BX,OFFSET LED
    	MOV AL,byte ptr key_in
        SUB al,30h
        CMP al,09h
        JNG  DIS2
        SUB al,07h
DIS2:  
        XLAT
    	MOV DX,a8255                  ;c8255->a8255
    	OUT DX,AL                     ;输出显示数据，段码
        POP AX
    	RET
DISPLY  ENDP

code ends
end start
```

##### 三、总结：
&emsp;&emsp;1.接线的时候插口需要对齐，错开一位会出错<br>
&emsp;&emsp;2.对.asm文件命名的时候，名称不要太长，会出错
 
#### 实验七 交通灯控制实验
##### 一、实验目的
&emsp;&emsp;通过并行接口8255实现十字路口交通灯的模拟控制,进一步掌握对并行口的使用。

##### 二、代码
```masm
;***********************************;
;* 十字路口红绿灯模拟演示程序 *;
;* 端口各灯的设置: *;
;* 1红 1黄 1绿 0 0 2红 2黄 2绿 *;
;***********************************;
data segment
    io8255a equ 28ah
    io8255b equ 28bh
    portc1 db 24h,44h,04h,44h,04h,44h,04h ;六个灯可能
    db 81h,82h,80h,82h,80h,82h,80h ;的状态数据
    db 0ffh ;结束标志
data ends

code segment
assume cs:code,ds:data
start:
    mov ax,data
    mov ds,ax
    mov dx,io8255b
    mov al,90h
    out dx,al ;设置8255为C口输出
    mov dx,io8255a

re_on: mov bx,0

on: 
    mov al,portc1[bx]
    mov cx,200 ;参数赋初值

    mov al,24h
    out dx,al
    mov cx,2000
de01: mov di,9000 ;di赋初值9000
de00:
    dec di ;减1计数
    jnz de00 ;di不为0
    loop de01

    mov al,44h
    out dx,al
    mov cx,200
de11: mov di,9000 ;di赋初值9000
de10: 
    dec di ;减1计数
    jnz de10 ;di不为0
    loop de11

    mov al,04h
    out dx,al
    mov cx,200
de21: mov di,9000 ;di赋初值9000
de20:
    dec di ;减1计数
    jnz de20 ;di不为0
    loop de21

    mov al,44h
    out dx,al
    mov cx,200
de31: mov di,9000 ;di赋初值9000
de30: 
    dec di ;减1计数
    jnz de30 ;di不为0
    loop de31

    mov al,04h
    out dx,al
    mov cx,200
de41: mov di,9000 ;di赋初值9000
de40: dec di ;减1计数
    jnz de40 ;di不为0
    loop de41

    mov al,44h
    out dx,al
    mov cx,200
de51: mov di,9000 ;di赋初值9000
de50: 
    dec di ;减1计数
    jnz de50 ;di不为0
    loop de51

    mov al,04h
    out dx,al
    mov cx,200
de61: mov di,9000 ;di赋初值9000
de60: 
    dec di ;减1计数
    jnz de60
    loop de61

    mov al,81h
    out dx,al
    mov cx,200
de03: mov di,9000 ;di赋初值9000
de04: 
    dec di ;减1计数
    jnz de04
    loop de03

    mov al,82h
    out dx,al
    mov cx,200
de13: mov di,9000 ;di赋初值9000
de14: 
    dec di ;减1计数
    jnz de14
    loop de13

    mov al,80h
    out dx,al
    mov cx,200
de23: mov di,9000 ;di赋初值9000
de24: 
    dec di ;减1计数
    jnz de24
    loop de23

    mov al,82h
    out dx,al
    mov cx,200
de33: mov di,9000 ;di赋初值9000
de34: 
    dec di ;减1计数
    jnz de34
    loop de33

    mov al,80h
    out dx,al
    mov cx,200
de43: mov di,90

00 ;di赋初值9000
de44: dec di ;减1计数
    jnz de44
    loop de43

    mov al,82h
    out dx,al
    mov cx,200
de53: mov di,9000 ;di赋初值9000
de54: dec di ;减1计数
    jnz de54
    loop de53

    mov al,80h
    out dx,al
    mov cx,200
de63: mov di,9000 ;di赋初值9000
de64: 
    dec di ;减1计数
    jnz de64
    loop de63

    jmp on ;没有,转到on

exit: 
    mov ah,4ch ;返回
    int 21h
code ends
end start
```

##### 三、总结
&emsp;&emsp;除了我的实验代码太冗余，本实验的实验逻辑还是比较简单的


#### 实验八 可编程定时器计数器8254 
##### 一、实验目的
&emsp;&emsp;掌握8254的基本原理和编程方法，用示波器观察不同方式下的波形

##### 二、代码
```masm
;*************************;
;*  8253方式0计数器实验  *;
;*************************;
io8253a        equ 283h
io8253b        equ 280h
code segment
    assume  cs:code
start: mov al,14h     	  ;15----14h
     mov dx,io8253a
     out dx,al
     mov dx,io8253b     	 ;送计数初值
     mov al,0fh   		;10---0fh 0000
     out dx,al
lll:     in al,dx        	 ;读计数初值
     call disp        		;调显示子程序
     push dx  
     mov ah,06h 
     mov dl,0ffh
     int 21h
     pop dx
     jz lll
     mov ah,4ch       ;退出
     int 21h
disp  proc near        ;显示子程序
     push dx
     and al,0fh  		 ;0f0---0fh    
     mov dl,al
     cmp dl,9         ;判断是否<=9
     jle  num  		;jge-----jle num      
     add dl,7         
num: add dl,30h
     mov ah,02h       ;显示
     int 21h
     mov dl,0dh       ;加回车符
     int 21h
     mov dl,0ah       ;加换行符
     int 21h
     pop dx
     ret              ;子程序返回
disp endp
code ends
end start 
```
```masm
;*******************
;*    8253分频    *
;*******************
io8253a        equ 280h
io8253b        equ 281h
io8253c        equ 283h
code segment
    assume   cs:code
start:mov dx,io8253c     ;向8254写控制字
    mov al,36h           ;54---36h 
    out dx,al
    mov ax,10000
    mov dx,io8253a
    out dx,al        
    mov al,ah
    out dx,al     
    mov dx,io8253c
    mov al,76h           ;66---76h 
    out dx,al
    mov ax,100    
    mov dx,io8253b
    out dx,al        
    mov al,ah
    out dx,al        
    mov ah,4ch      
    int 21h
  code ends
    end start
```

##### 三、总结：
&emsp;&emsp;1.习惯用法是下降沿的波形<br>
&emsp;&emsp;2.8254内部原来是有3个计数器级联的，也就是说这种结构的好处就是并行化
